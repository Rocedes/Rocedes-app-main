
<!--https://github.com/mazdik/ng-modal-->
 <!--<button class="dt-button" (click)="modal1.show()">Open panel 1</button>&nbsp;
 <button class="dt-button" (click)="modal2.show()">Open panel 2</button>&nbsp;
 <button class="dt-button" (click)="modal3.show()">Open panel 2</button>&nbsp;
   <app-modal #modal1
              class="panel-demo1"
              [maximizable]="true"
              [backdrop]="true">
     <ng-container class="app-modal-header">Panel 1</ng-container>
     <ng-container class="app-modal-body">
       <h3>MODAL DIALOG</h3>
       <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.
         Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s.</p>
     </ng-container>
     <ng-container class="app-modal-footer">
       <button class="dt-button dt-red">Delete</button>&nbsp;
       <button class="dt-button dt-green">Save</button>
       <button class="dt-button dt-blue" style="float: right;" (click)="modal1.hide()">Close</button>
     </ng-container>
   </app-modal>
   <app-modal #modal2
              class="panel-demo2"
              [maximizable]="true"
              [backdrop]="false">
     <ng-container class="app-modal-header">Panel 2</ng-container>
     <ng-container class="app-modal-body">
       <h3>MODAL DIALOG</h3>
       <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.
         Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s.</p>
     </ng-container>
     <ng-container class="app-modal-footer">
       <button class="dt-button dt-red">Delete</button>&nbsp;
       <button class="dt-button dt-green">Save</button>
       <button class="dt-button dt-blue" style="float: right;" (click)="modal2.hide()">Close</button>
     </ng-container>
   </app-modal>
   <app-modal #modal3
              class="panel-demo3"
              [maximizable]="true"
              [backdrop]="false">
     <ng-container class="app-modal-header">Panel 3</ng-container>
     <ng-container class="app-modal-body">
       <h3>MODAL DIALOG</h3>
       <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.
         Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s.</p>
     </ng-container>
     <ng-container class="app-modal-footer">
       <button class="dt-button dt-red">Delete</button>&nbsp;
       <button class="dt-button dt-green">Save</button>
       <button class="dt-button dt-blue" style="float: right;" (click)="modal3.hide()">Close</button>
     </ng-container>
   </app-modal>-->


<ng-container *ngIf="str_from == 'frmUsuario' || str_from == 'dialog'; then frmUsuario; else second"></ng-container>
<ng-template #second>
    <ng-container *ngIf="str_from == 'frmRegistros'; then frmRegistros;  else third"></ng-container></ng-template>
<ng-template #third></ng-template>




<!-----------------------------------------------------USUARIOS--------------------------------------------------------------->
<ng-template #frmUsuario>
  <div class="formulario" id="divUsuario">

      <div class="head-form" id="from-encabezado">
        <div class="from-encabezado-titulo"><p>Usuario</p></div>
        <div class="from-encabezado-salir"><a href="#" (click)="Cerrar()"><fa-icon [icon]="['fas', 'sign-out-alt']" class="fa-lg" style="color:white"></fa-icon></a></div>
      </div>

      <div class="container">
          <form class="form"   [formGroup]="val.ValForm"  novalidate>

              
              <div class="row">
                  <mat-form-field class="col-12">
                      <mat-label>Código Barra.</mat-label>
                      <input appAutofocus matInput type="text" id="txtCodbar"  formControlName="txtCodbar" placeholder=""   (keydown.enter)="onKeyEnter($event)">
                      <mat-icon matSuffix><fa-icon [icon]="['fas', 'barcode']" class="fa-lg" *ngIf="!bol_Load else spinBar"></fa-icon></mat-icon>
                      <mat-error *ngIf="val.ValForm.get('txtCodbar')?.errors?.Regla=='1'">Código Barra es <strong>requerido</strong></mat-error>
                    </mat-form-field>

              </div> 

              <div class="row">
                  <mat-form-field class="col-sm-12 col-md-12 col-lg-6">
                      <mat-label>Nombres.</mat-label>
                          <mat-label></mat-label>
                          <input matInput type="text" id="txtNombre" formControlName="txtNombre"  placeholder=""   (keydown.enter)="onKeyEnter($event)">
                          <mat-error *ngIf="val.ValForm.get('txtNombre')?.errors?.Regla=='1'">Nombres es <strong>requerido</strong></mat-error>
                  </mat-form-field>

                  <mat-form-field class="col-sm-6 col-md-12 col-lg-6">
                      <mat-label>Apellidos.</mat-label>
                          <mat-label></mat-label>
                          <input matInput type="text" id="txtApellido" formControlName="txtApellido" placeholder=""  (keydown.enter)="onKeyEnter($event)">
                          <mat-error *ngIf="val.ValForm.get('txtApellido')?.errors?.Regla=='1'">Apellidos es <strong>requerido</strong></mat-error>
                  </mat-form-field>
              </div> 


        
              <div class="row">
                  <mat-card class="mat-card">
                      
                      <mat-card-header>
                          <mat-card-title class="mat-card-title">Acceso Sistema</mat-card-title>
                      </mat-card-header>

                      <mat-card-content class="row">
                          <mat-form-field class="col-sm-12 col-md-5 col-lg-5">
                              <mat-label>Usuario.</mat-label>
                              <input matInput type="text" formControlName="txtUsuario" id="txtUsuario"  (keydown.enter)="onKeyEnter($event)">
                              <mat-icon matPrefix>person</mat-icon>
                              <mat-error *ngIf="val.ValForm.get('txtUsuario')?.errors?.Regla=='1'">Usuario es <strong>requerido</strong></mat-error>
                              <mat-error *ngIf="val.ValForm.get('txtUsuario')?.errors?.Regla=='2'">Debe de contener al menos <strong>5</strong> cáracteres</mat-error>
                          </mat-form-field>
                          
                          
                          <mat-form-field class="col-sm-12 col-md-5 col-lg-5 offset-md-2">
                              <mat-label>Contraseña.</mat-label>
                              <input matInput  [type]="bol_HidePass ? 'password' : 'text'" id="txtPass"  formControlName="txtPass" placeholder="Contraseña"  (keydown.enter)="onKeyEnter($event)">
                              <mat-icon matSuffix (click)="bol_HidePass = !bol_HidePass">{{bol_HidePass ? 'visibility_off' : 'visibility'}}</mat-icon>
                              <mat-icon matPrefix >lock</mat-icon>
                              <mat-error *ngIf="val.ValForm.get('txtPass')?.errors?.Regla=='1'">Usuario es <strong>requerido</strong></mat-error>
                              <mat-error *ngIf="val.ValForm.get('txtPass')?.errors?.Regla=='2'">Debe de contener al menos <strong>6</strong> cáracteres</mat-error>
                              <!--<mat-icon matSuffix>lock</mat-icon>-->
                          </mat-form-field>
      
                      </mat-card-content>
                      
                      
                  </mat-card>
              </div>
  
              <div class="row">
                  <div class="col-12">
                      <div class="button-row text-end">
                          <!--<button mat-button color="primary">
                              <mat-icon>save</mat-icon>
                              Guardar
                          </button>
                          
                          <button mat-button >
                              <mat-icon>cleaning_services</mat-icon>
                              Limpiar
                          </button>-->

          
                          <button type="button" id="btnGuardar" [disabled]="val.ValForm.invalid"  class="btn btn-outline-success"  (click)="fn_nUsuario()" ><fa-icon [icon]="['fas', 'save']" class="fa-lg"></fa-icon> Guardar</button>
                          <button type="button" id="btnCancelar" class="btn btn-outline-secondary" (click)="LimpiarForm()" *ngIf="str_from!='dialog'"><fa-icon [icon]="['fas', 'broom']" class="fa-lg"></fa-icon> Cancelar</button>
                          <button type="button" id="btnCerrar" class="btn btn-outline-secondary" (click)="Cerrar()" *ngIf="str_from=='dialog'"><fa-icon [icon]="['fas', 'door-closed']" class="fa-lg"></fa-icon>Cerrar</button>
                      </div>
                  </div>
              </div>


             
             

             
          </form>
      </div>
      
  </div>

</ng-template>



<!-----------------------------------------------------SPINNER---------------------------------------------------------------->

<ng-template #spinBar>
    <div style="text-align: right;">
        <div class="spinner-border text-primary" role="status" >
            <span class="sr-only">Loading...</span>
          </div>
    </div>
</ng-template>




<!-----------------------------------------------------REGISTROS USUARIOS----------------------------------------------------->
<ng-template #frmRegistros>

  <div class="Lista-Registro" id="divRegistrosUsuario">
    <div class="franja"><p>Registros de Usuarios</p></div>

    <div>

      <mat-form-field class="col-ms-12">
        <mat-label>Buscar</mat-label>
        <input appAutofocus matInput (keyup)="filtrar($event)" placeholder="buscar">
      </mat-form-field>

   
        <div class="mat-elevation-z8">
          <table mat-table [dataSource]="dataSourceUsuario" matSort (matSortChange)="announceSortChange($event)">
        

          <ng-container matColumnDef="cIndex">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by cIndex">
              No.
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cIndex}} </td>
          </ng-container>

          <ng-container matColumnDef="cIdUsuario">
            <th mat-header-cell *matHeaderCellDef>
              IdUsuario
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cIdUsuario}} </td>
          </ng-container>

          <ng-container matColumnDef="cUsuario">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by cUsuario">
              Usuario
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cUsuario}} </td>
          </ng-container>
        

          <ng-container matColumnDef="cPass">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by cPass">
              Pass
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cPass}} </td>
          </ng-container>
        
      
         

          <ng-container matColumnDef="cNombre">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by cNombre">
              Nombre
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cNombre}} </td>
          </ng-container>
        

          <ng-container matColumnDef="cApellido">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by cApellido">
              Apellido
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cApellido}} </td>
          </ng-container>

          <ng-container matColumnDef="cCodBar">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by cCodBar">
              CodBar
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cCodBar}} </td>
          </ng-container>

          <ng-container matColumnDef="cActivo">
            <th mat-header-cell *matHeaderCellDef>
              Activo
            </th>
            <td mat-cell *matCellDef="let element" >
              <fa-icon *ngIf="element.cActivo" [icon]="['fas', 'check']"  class="fa-2x" ></fa-icon>
            </td>
          </ng-container>

          <ng-container matColumnDef="cAccion1">
            <th mat-header-cell *matHeaderCellDef>
            </th>
            <td mat-cell *matCellDef="let element" >
              <a href="#" id="aEditar" (click)="clickRow('Editar', element)" *ngIf="element.cActivo"><fa-icon [icon]="['fas', 'user-edit']"  class="fa-2x" ></fa-icon></a>
            </td>
          </ng-container>

          
          <ng-container matColumnDef="cAccion2">
            <th mat-header-cell *matHeaderCellDef>
            </th>
            <td mat-cell *matCellDef="let element" >
              <a href="#" id="aActivar" (click)="clickRow('Activar', element)" *ngIf="!element.cActivo"><fa-icon [icon]="['fas', 'trash-restore']" class="fa-2x" style="color:green"></fa-icon></a>
            </td>
          </ng-container>

          
          <ng-container matColumnDef="cAccion3">
            <th mat-header-cell *matHeaderCellDef>
            </th>
            <td mat-cell *matCellDef="let element" >
              <a href="#" id="aEliminar" (click)="clickRow('Eliminar', element)" *ngIf="element.cActivo"><fa-icon [icon]="['fas', 'trash-alt']" class="fa-2x" style="color:red"></fa-icon></a>
            </td>
          </ng-container>


          

        
        
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr
          mat-row  [class.demo-row-is-clicked]="clickedRows.has(row)" *matRowDef="let row; columns: displayedColumns;"></tr>
          
        </table>
        <mat-paginator [pageSizeOptions]="[25, 50, 100, 1000]"  showFirstLastButtons></mat-paginator>
        </div>

        

    </div>
  </div>
    

</ng-template>
